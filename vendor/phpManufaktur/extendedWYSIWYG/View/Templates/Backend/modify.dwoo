{* 
 * extendedWYSIWYG
 *
 * @author Team phpManufaktur <team@phpmanufaktur.de>
 * @link https://addons.phpmanufaktur.de/extendedWYSIWYG
 * @copyright 2012 Ralf Hertsch <ralf.hertsch@phpmanufaktur.de>
 * @license MIT License (MIT) http://www.opensource.org/licenses/MIT
 *
 * Please consult the Dwoo Documentation & WIKI to get further informations 
 * and hints for the usage of the Dwoo template engine.
 *
 * @link http://wiki.dwoo.org/
 *
 * Use {dump()} to get a list of all in this template available variables!
 *}
<form name="wysiwyg{$section.id}">
  <input type="hidden" name="{$page.name}" value="{$page.id}" />
  <input type="hidden" name="{$section.name}" value="{$section.id}" />
  <input type="hidden" name="archive_id" value="{$archive['id']}" /> 
  <input type="hidden" name="teaser_id" value="{$options.use_as_blog.fields.teaser.id}" />
  <input type="hidden" id="{$editorial.editor.name}" name="{$editorial.editor.name}" value="{$editorial.editor.value}" />
  <div class="wysiwyg_system">
    <div class="wysiwyg_options">
      {if $options.page_settings.active == 1}
      <input id="{$options.page_settings.checkbox.name}" type="checkbox" name="{$options.page_settings.checkbox.name}" value="{$options.page_settings.checkbox.value}"{if $options.page_settings.checkbox.checked == 1} checked="checked"{/if} /> {translate('Show Page Settings')}
      {/if}
      {if $options.use_as_blog.active == 1}
      <input id="{$options.use_as_blog.checkbox.name}" type="checkbox" name="{$options.use_as_blog.checkbox.name}" value="{$options.use_as_blog.checkbox.value}"{if $options.use_as_blog.checkbox.checked == 1} checked="checked"{/if} /> {translate('Actual Message')}
      {/if}
      <input id="{$options.hide_section.checkbox.name}" type="checkbox" name="{$options.hide_section.checkbox.name}" value="{$options.hide_section.checkbox.value}"{if $options.hide_section.checkbox.checked == 1} checked="checked"{/if} /> {translate('Hide Section')}
    </div>
    {if $section.is_first == 1}
    [<a id="about" href="{$link.settings.url}" target="_blank">{translate('Settings')}</a>]
    {/if}
  </div>
  <div id="wysiwyg_info_{$section.id}">
    {if $message.is_message == 1}
      <div class="wysiwyg_message">{$message.text}</div>
    {/if}
  </div>
  <div id="wysiwyg_container_{$section.id}">
    {if $options.page_settings.active == 1}
      {include('modify.page_settings.dwoo')}
    {/if}
    {if $options.use_as_blog.active == 1}
      {include('modify.use_as_blog.dwoo')}
    {/if}
    
    {if $editorial.is_locked == 1}
      {include('modify.editorial.is_locked.dwoo')}      
    {else}
      {if $editorial.editor.action.value == 'APPROVE'}
        {include('modify.editorial.approve.dwoo')}
      {else}
        <div class="wysiwyg_editor">
          {show_wysiwyg_editor($section.editor_id, $section.editor_id, $section.text, '100%', '250px', 'Smart')}
        </div>
        <input type="hidden" name="{$editorial.editor.action.name}" value="{$editorial.editor.action.value}" />
        <div style="display: none;">
          {* the editor response must be defined as radiobutton so we use display:none to hide it !!! *}
          <input type="radio" name="{$editorial.editor.response.name}" value="{$editorial.editor.response.value}" checked="checked"/>
        </div>
        <div class="wysiwyg_control">
          {if $editorial.is_active == 0}
            <div class="wysiwyg_control_publish">
              <input id="{$publish.name}" type="checkbox" name="{$publish.name}" value="{$publish.value}"{if $publish.status == 1} checked="checked"{/if} />
              <label for="{$publish.name}">{translate('Publish section')}</label>
            </div>
          {elseif $editorial.editor.permissions.release_by_own == 1}
            <div class="wysiwyg_control_publish editorial">
              <input id="{$editorial.email.send.name}" name="{$editorial.email.send.name}" type="checkbox" value="{$editorial.email.send.value}" />
              <label for="{$editorial.email.send.name}" title="{translate('Send a email to the other editors of this department')}">{translate('Message')}</label>
              <input id="{$editorial.approval.name}" name="{$editorial.approval.name}" type="checkbox" value="{$editorial.approval.value}" />
              <label for="{$editorial.approval.name}" title="{translate('Be careful: you are allowed to publish this section without any approval!')}">{translate('Release by own')}</label>
            </div>
          {else}
            <div class="wysiwyg_control_publish editorial">
              <input id="{$editorial.email.send.name}" name="{$editorial.email.send.name}" type="checkbox" value="{$editorial.email.send.value}" />
              <label for="{$editorial.email.send.name}" title="{translate('Send a email to the other editors of this department')}">{translate('Message')}</label>
              <input id="{$editorial.approval.name}" name="{$editorial.approval.name}" type="checkbox" value="{$editorial.approval.value}" />
              <label for="{$editorial.approval.name}" title="{translate('Request the approval for release of this section by your supervisors')}">{translate('Approve publishing')}</label>
            </div>
          {/if}
          <div class="wysiwyg_control_archiv_id">
            <select id="{$archive.name}" name="{$archive.name}" > 
              {foreach $archive.items item}
              <option value="{$item.value}"{if $item.value == $archive.id} selected="selected"{/if}>{$item.text}</option>
              {/foreach}
            </select>
          </div>
          <div class="wysiwyg_control_author">{$author}</div>

          <div class="wysiwyg_control_counter">
            {$count.chars} {translate('Chars')} - {$count.words} {translate('Words')}
          </div>
          <div class="wysiwyg_control_clear"></div>
        </div>
        {if $editorial.email.pending.count > 0}
          {include('modify.editorial.email.pending.dwoo')}
        {/if}
        <div id="email_container_{$section.id}">
          <!-- placeholder for the email dialog -->
        </div>
        <div class="wysiwyg_editor_buttons">
          <input id="save_{$section.id}" type="button" value="{translate('Save')}" /> 
          <input type="button" value="{translate('Abort')}" onclick="javascript:window.location='index.php';" />
        </div>
      {/if}
    {/if}
  </div><!-- /wysiwyg_container -->
</form>
